<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ·˜å®å¹¿å‘Šç‚¹å‡»é‡å¤§æ•°æ®åˆ†æç³»ç»Ÿ</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif;
    }

    body {
      background-color: #0f1a2f;
      display: flex;
      height: 100vh;
      overflow: hidden;
      color: #fff;
    }

    /* ä¾§è¾¹å¯¼èˆªæ  */
    .sidebar {
      width: 200px;
      background-color: #1a243f;
      color: #fff;
      display: flex;
      flex-direction: column;
      height: 100%;
      padding-top: 20px;
      transition: width 0.3s ease;
      border-right: 1px solid #2a3655;
    }

    .sidebar-header {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 0 20px 20px;
      border-bottom: 1px solid #2a3655;
    }

    .sidebar-header i {
      font-size: 24px;
      color: #00a1ff;
    }

    .sidebar-header h2 {
      font-size: 16px;
      font-weight: 600;
      color: #00a1ff;
    }

    .sidebar-menu {
      flex: 1;
      padding: 20px 0;
    }

    .menu-item {
      padding: 12px 20px;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 14px;
      text-decoration: none;
      color: #b8c2d9;
      display: block;
      border-left: 3px solid transparent;
      position: relative;
    }

    /* æŠ˜å èœå•çš„ç®­å¤´æ ·å¼ */
    .menu-item.has-submenu::after {
      content: "\f078";
      font-family: "Font Awesome 6 Free";
      font-weight: 900;
      font-size: 10px;
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      transition: transform 0.3s ease;
      color: #b8c2d9;
    }

    .menu-item.has-submenu.collapsed::after {
      transform: translateY(-50%) rotate(-90deg);
    }

    .menu-item.active {
      background-color: rgba(0, 161, 255, 0.1);
      color: #00a1ff;
      border-left-color: #00a1ff;
    }

    .menu-item:hover:not(.active) {
      background-color: rgba(255, 255, 255, 0.05);
      color: #fff;
    }

    .menu-item i {
      width: 18px;
      text-align: center;
    }

    .submenu {
      padding-left: 40px;
      background-color: #151e35;
      display: none; /* é»˜è®¤éšè— */
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    .submenu.show {
      display: block;
      max-height: 500px; /* è¶³å¤Ÿå¤§çš„é«˜åº¦å®¹çº³å­èœå• */
    }

    .submenu .menu-item {
      padding: 10px 20px;
      font-size: 13px;
    }

    /* ä¸»å†…å®¹åŒº */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      height: 100%;
      overflow-y: auto;
      transition: margin-left 0.3s ease;
    }

    /* é¡¶éƒ¨å¯¼èˆªæ  */
    .topbar {
      height: 60px;
      background-color: #1a243f;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      border-bottom: 1px solid #2a3655;
    }

    .topbar-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .topbar-menu-btn {
      font-size: 18px;
      cursor: pointer;
      color: #b8c2d9;
    }

    .topbar-title {
      font-size: 18px;
      font-weight: 600;
      color: #00a1ff;
    }

    /* æ¬¢è¿æ  */
    .welcome-bar {
      background: linear-gradient(135deg, #0f1a2f 0%, #1a2b4f 100%);
      color: #fff;
      padding: 30px 40px;
      margin: 20px;
      border-radius: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 1px solid #2a3655;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .welcome-info {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .welcome-avatar {
      width: 60px;
      height: 60px;
      border-radius: 12px;
      background: linear-gradient(135deg, #00a1ff 0%, #0080ff 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      box-shadow: 0 5px 15px rgba(0, 161, 255, 0.3);
    }

    .welcome-text h3 {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 10px;
      background: linear-gradient(90deg, #00a1ff, #00ffaa);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .welcome-text p {
      font-size: 16px;
      color: #b8c2d9;
      line-height: 1.6;
    }

    .welcome-time {
      text-align: right;
      background: rgba(0, 0, 0, 0.2);
      padding: 15px 25px;
      border-radius: 8px;
      border: 1px solid #2a3655;
    }

    .time-clock {
      font-size: 28px;
      font-weight: 600;
      margin-bottom: 5px;
      color: #00ffaa;
      font-family: 'Courier New', monospace;
    }

    .time-date {
      font-size: 16px;
      color: #b8c2d9;
    }

    /* æ•°æ®å¡ç‰‡åŒº */
    .data-cards {
      padding: 0 20px;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-bottom: 20px;
    }

    .data-card {
      background: linear-gradient(135deg, #1a243f 0%, #223056 100%);
      border-radius: 12px;
      padding: 25px 20px;
      display: flex;
      align-items: center;
      gap: 15px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      cursor: pointer;
      transition: all 0.3s ease;
      border: 1px solid #2a3655;
    }

    .data-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0, 161, 255, 0.2);
      border-color: #00a1ff;
    }

    .card-icon {
      width: 50px;
      height: 50px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      color: #fff;
    }

    .icon-purple {
      background: linear-gradient(135deg, #9c27b0 0%, #673ab7 100%);
    }

    .icon-pink {
      background: linear-gradient(135deg, #e91e63 0%, #c2185b 100%);
    }

    .icon-blue {
      background: linear-gradient(135deg, #2196f3 0%, #0d47a1 100%);
    }

    .icon-green {
      background: linear-gradient(135deg, #4caf50 0%, #2e7d32 100%);
    }

    .icon-orange {
      background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
    }

    .icon-teal {
      background: linear-gradient(135deg, #009688 0%, #00695c 100%);
    }

    .card-data h4 {
      font-size: 28px;
      font-weight: 700;
      color: #fff;
      margin-bottom: 5px;
    }

    .card-data p {
      font-size: 14px;
      color: #b8c2d9;
    }

    /* å¤§å±å±•ç¤ºåŒº */
    .dashboard-area {
      padding: 0 20px 30px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .dashboard-card {
      background: linear-gradient(135deg, #1a243f 0%, #223056 100%);
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      border: 1px solid #2a3655;
      transition: all 0.3s ease;
    }

    .dashboard-card:hover {
      box-shadow: 0 15px 35px rgba(0, 161, 255, 0.15);
    }

    .dashboard-title {
      font-size: 18px;
      font-weight: 600;
      color: #00a1ff;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #2a3655;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .dashboard-title i {
      font-size: 20px;
    }

    .chart-container {
      height: 400px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      width: 100%;
    }

    /* åŠ è½½ä¸­æ ·å¼ */
    .loading {
      text-align: center;
      color: #b8c2d9;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .loading i {
      font-size: 40px;
      margin-bottom: 15px;
      color: #00a1ff;
      animation: spin 1.5s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* å†…å®¹å®¹å™¨ */
    .content-wrapper {
      flex: 1;
      overflow-y: auto;
      padding-bottom: 20px;
    }

    /* å…¶ä»–é¡µé¢æ ·å¼ */
    .page-content {
      padding: 30px;
      width: 100%;
    }

    .page-title {
      font-size: 28px;
      font-weight: 600;
      margin-bottom: 20px;
      color: #00a1ff;
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .page-desc {
      font-size: 16px;
      color: #b8c2d9;
      margin-bottom: 30px;
      line-height: 1.8;
      background: rgba(0, 0, 0, 0.2);
      padding: 20px;
      border-radius: 8px;
      border: 1px solid #2a3655;
    }

    /* è¯¦æƒ…é¡µé¢æ ·å¼ */
    .detail-section {
      background: linear-gradient(135deg, #1a243f 0%, #223056 100%);
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 20px;
      border: 1px solid #2a3655;
    }

    .detail-title {
      font-size: 20px;
      font-weight: 600;
      color: #00ffaa;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid #2a3655;
    }

    .detail-content {
      color: #b8c2d9;
      line-height: 1.8;
    }

    .detail-item {
      margin-bottom: 15px;
      padding: 10px;
      background: rgba(0, 0, 0, 0.1);
      border-radius: 6px;
    }

    .detail-item strong {
      color: #00a1ff;
      margin-right: 10px;
    }

    /* å›¾è¡¨å®¹å™¨å¼ºåˆ¶æ ·å¼ */
    #behaviorChart, #trendChart, #convertChart {
      width: 100% !important;
      height: 400px !important;
      min-height: 400px !important;
    }

    /* å“åº”å¼è°ƒæ•´ */
    @media (max-width: 1200px) {
      .data-cards {
        grid-template-columns: repeat(2, 1fr);
      }

      .dashboard-area {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .data-cards {
        grid-template-columns: 1fr;
      }

      .welcome-bar {
        flex-direction: column;
        gap: 20px;
        text-align: center;
      }

      .welcome-time {
        text-align: center;
      }
    }
  </style>
  <!-- å¼•å…¥å›¾æ ‡åº“ -->
  <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- æ”¹ç”¨ç¨³å®šCDNå¼•å…¥ECharts -->
  <script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
</head>

<body>
  <!-- ä¾§è¾¹å¯¼èˆªæ  -->
  <div class="sidebar">
    <div class="sidebar-header">
      <i class="fas fa-chart-line"></i>
      <h2>å¹¿å‘Šæ•°æ®åˆ†æ</h2>
    </div>
    <div class="sidebar-menu">
      <!-- ç³»ç»Ÿé¦–é¡µ -->
      <div class="menu-item" data-route="/index">
        <i class="fas fa-home"></i>
        <span>ç³»ç»Ÿé¦–é¡µ</span>
      </div>
      <!-- éœ€æ±‚1ï¼šå¹¿å‘Šç‚¹å‡»ç‡éšæ—¶é—´å˜åŒ–è¶‹åŠ¿åˆ†æ -->
      <div class="menu-item" data-route="/requirement1">
        <i class="fas fa-clock"></i>
        <span>ç‚¹å‡»ç‡æ—¶é—´è¶‹åŠ¿</span>
      </div>
      <!-- éœ€æ±‚2ï¼šç”¨æˆ·ç‚¹å‡»è¡Œä¸ºåˆ†å¸ƒåˆ†æ -->
      <div class="menu-item" data-route="/requirement2">
        <i class="fas fa-chart-pie"></i>
        <span>ç”¨æˆ·è¡Œä¸ºåˆ†å¸ƒ</span>
      </div>
      <!-- éœ€æ±‚3ï¼šç”¨æˆ·æ¶ˆè´¹æ¡£æ¬¡ä¸ç‚¹å‡»ç‡å…³ç³»åˆ†æ -->
      <div class="menu-item" data-route="/requirement3">
        <i class="fas fa-money-bill-wave"></i>
        <span>æ¶ˆè´¹æ¡£æ¬¡åˆ†æ</span>
      </div>
      <!-- éœ€æ±‚4ï¼šä¸åŒåŸå¸‚å±‚çº§å¹¿å‘Šç‚¹å‡»åå¥½åˆ†æ -->
      <div class="menu-item" data-route="/requirement4">
        <i class="fas fa-city"></i>
        <span>åŸå¸‚å±‚çº§åå¥½</span>
      </div>
      <!-- éœ€æ±‚5ï¼šè´­ç‰©æ·±åº¦ç”¨æˆ·ä»·å€¼åˆ†æï¼ˆå¯æŠ˜å ï¼‰ -->
      <div class="menu-item has-submenu" id="shoppingLevelParent">
        <i class="fas fa-shopping-cart"></i>
        <span>è´­ç‰©æ·±åº¦åˆ†æ</span>
      </div>
      <!-- æ–°å¢ï¼šè´­ç‰©æ·±åº¦å­èœå•ï¼ˆå¯æ”¶ç¼©ï¼‰ -->
      <div class="submenu" id="shoppingLevelSubmenu">
        <div class="menu-item" data-route="/shoppingLevel/behavior">
          <i class="fas fa-list"></i>
          <span>è´­ç‰©æ·±åº¦-è¡Œä¸ºåˆ†å¸ƒ</span>
        </div>
        <div class="menu-item" data-route="/shoppingLevel/trend">
          <i class="fas fa-chart-line"></i>
          <span>è´­ç‰©æ·±åº¦-æ—¶é—´è¶‹åŠ¿</span>
        </div>
        <div class="menu-item" data-route="/shoppingLevel/convert">
          <i class="fas fa-percentage"></i>
          <span>è´­ç‰©æ·±åº¦-è½¬åŒ–ç‡</span>
        </div>
      </div>
      <!-- è¯¦æƒ…åˆ†æ -->
      <div class="menu-item" data-route="/detail">
        <i class="fas fa-info-circle"></i>
        <span>è¯¦æƒ…åˆ†æ</span>
      </div>
    </div>
  </div>

  <!-- ä¸»å†…å®¹åŒº -->
  <div class="main-content">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <div class="topbar">
      <div class="topbar-left">
        <div class="topbar-menu-btn" id="sidebarToggle">
          <i class="fas fa-bars"></i>
        </div>
        <div class="topbar-title" id="currentPageTitle">æ·˜å®å¹¿å‘Šç‚¹å‡»é‡å¤§æ•°æ®åˆ†æ</div>
      </div>
    </div>

    <!-- å†…å®¹å®¹å™¨ -->
    <div class="content-wrapper" id="contentWrapper">
      <!-- åˆå§‹å†…å®¹ï¼šç³»ç»Ÿé¦–é¡µ -->
      <div class="welcome-bar">
        <div class="welcome-info">
          <div class="welcome-avatar">
            <i class="fas fa-chart-bar"></i>
          </div>
          <div class="welcome-text">
            <h3>æ·˜å®å¹¿å‘Šç‚¹å‡»é‡å¤§æ•°æ®åˆ†æç³»ç»Ÿ</h3>
            <p>å®æ—¶ç›‘æ§æ·˜å®å¹¿å‘Šç‚¹å‡»æ•°æ®ï¼Œæ·±åº¦åˆ†æç”¨æˆ·è¡Œä¸ºæ¨¡å¼<br>
              åŸºäºå¤§æ•°æ®æŠ€æœ¯å®ç°ç²¾å‡†è¥é”€å†³ç­–æ”¯æŒ<br>
              <span style="font-size: 14px; color: #00ffaa;">æ•°æ®æ¥æºï¼šæ·˜å®å¹¿å‘Šç³»ç»Ÿ | æ›´æ–°æ—¶é—´ï¼šå®æ—¶</span>
            </p>
          </div>
        </div>
        <div class="welcome-time">
          <div class="time-clock">00:34:05</div>
          <div class="time-date">2025å¹´12æœˆ5æ—¥ æ˜ŸæœŸäº”</div>
          <div class="time-weather">ğŸ“Š æ•°æ®è¿è¡Œæ­£å¸¸</div>
        </div>
      </div>

      <div class="data-cards">
        <div class="data-card" data-route="/requirement1">
          <div class="card-icon icon-purple">
            <i class="fas fa-clock"></i>
          </div>
          <div class="card-data">
            <h4>2.34%</h4>
            <p>å¹³å‡ç‚¹å‡»ç‡</p>
          </div>
        </div>
        <div class="data-card" data-route="/requirement2">
          <div class="card-icon icon-pink">
            <i class="fas fa-mouse-pointer"></i>
          </div>
          <div class="card-data">
            <h4>8.7M</h4>
            <p>æ—¥ç‚¹å‡»é‡</p>
          </div>
        </div>
        <div class="data-card" data-route="/requirement3">
          <div class="card-icon icon-blue">
            <i class="fas fa-users"></i>
          </div>
          <div class="card-data">
            <h4>156K</h4>
            <p>æ´»è·ƒç”¨æˆ·æ•°</p>
          </div>
        </div>
        <div class="data-card" data-route="/requirement4">
          <div class="card-icon icon-green">
            <i class="fas fa-map-marker-alt"></i>
          </div>
          <div class="card-data">
            <h4>32</h4>
            <p>è¦†ç›–åŸå¸‚æ•°</p>
          </div>
        </div>
      </div>

      <!-- å¤§å±å±•ç¤ºåŒº -->
      <div class="dashboard-area">
        <div class="dashboard-card">
          <div class="dashboard-title">
            <i class="fas fa-chart-line"></i>
            <span>å®æ—¶ç‚¹å‡»è¶‹åŠ¿ç›‘æ§</span>
          </div>
          <div class="chart-container">
            <div style="text-align: center; color: #b8c2d9;">
              <i class="fas fa-chart-line" style="font-size: 60px; margin-bottom: 20px; color: #00a1ff;"></i>
              <p>å®æ—¶æ•°æ®å¯è§†åŒ–å±•ç¤º</p>
              <p style="font-size: 14px; margin-top: 10px;">æ¯å°æ—¶æ›´æ–°ä¸€æ¬¡</p>
            </div>
          </div>
        </div>

        <div class="dashboard-card">
          <div class="dashboard-title">
            <i class="fas fa-chart-pie"></i>
            <span>ç”¨æˆ·è¡Œä¸ºåˆ†å¸ƒ</span>
          </div>
          <div class="chart-container">
            <div style="text-align: center; color: #b8c2d9;">
              <i class="fas fa-pie-chart" style="font-size: 60px; margin-bottom: 20px; color: #00ffaa;"></i>
              <p>ç‚¹å‡»/æœªç‚¹å‡»åˆ†å¸ƒæ¯”ä¾‹</p>
              <p style="font-size: 14px; margin-top: 10px;">å®æ—¶ç»Ÿè®¡æ•°æ®</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ========== æ ¸å¿ƒä¿®å¤1ï¼šæ—¶é—´æ›´æ–°å‡½æ•°å¢å¼º ==========
    function updateTime() {
      const now = new Date();
      const hours = now.getHours().toString().padStart(2, '0');
      const minutes = now.getMinutes().toString().padStart(2, '0');
      const seconds = now.getSeconds().toString().padStart(2, '0');

      // ä¸¥æ ¼æ ¡éªŒDOMå…ƒç´ å­˜åœ¨æ€§
      const timeClock = document.querySelector('.time-clock');
      if (timeClock) {
        timeClock.textContent = `${hours}:${minutes}:${seconds}`;
      }

      // æ›´æ–°æ—¥æœŸ
      const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
      const dateStr = now.toLocaleDateString('zh-CN', options);
      const timeDate = document.querySelector('.time-date');
      if (timeDate) {
        timeDate.textContent = dateStr;
      }
    }
    updateTime();
    setInterval(updateTime, 1000);

    // ========== æ ¸å¿ƒä¿®å¤2ï¼šæ¥å£è¯·æ±‚ä¸æ¨¡æ‹Ÿæ•°æ®ä¼˜åŒ– ==========
    // æ¥å£åŸºç¡€åœ°å€ï¼ˆè¯·æ›¿æ¢ä¸ºä½ çš„çœŸå®åç«¯æ¥å£åœ°å€ï¼‰
    const API_BASE_URL = 'http://localhost:5000/api';

    // é€šç”¨æ¥å£è¯·æ±‚å‡½æ•°ï¼ˆå¢åŠ è¶…æ—¶å’Œé”™è¯¯å…œåº•ï¼‰
    async function fetchApiData(url, method = 'GET', data = {}) {
      try {
        // è®¾ç½®è¯·æ±‚è¶…æ—¶
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 5000);

        const options = {
          method: method,
          headers: {
            'Content-Type': 'application/json'
          },
          signal: controller.signal
        };

        if (method !== 'GET') {
          options.body = JSON.stringify(data);
        }

        const response = await fetch(`${API_BASE_URL}${url}`, options);
        clearTimeout(timeoutId);

        if (!response.ok) {
          throw new Error(`æ¥å£è¯·æ±‚å¤±è´¥ï¼š${response.status}`);
        }

        const result = await response.json();
        return result.code === 200 ? result.data : getMockData(url);
      } catch (error) {
        console.warn('æ¥å£è¯·æ±‚å¤±è´¥ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼š', error.message);
        return getMockData(url);
      }
    }

    // æ¨¡æ‹Ÿæ•°æ®ï¼ˆå¢å¼ºæ•°æ®å®Œæ•´æ€§ï¼‰
    function getMockData(url) {
      switch(url) {
        case '/shoppingLevel/behavior':
          return {
            xAxis: ['è´­ç‰©æ·±åº¦1', 'è´­ç‰©æ·±åº¦2', 'è´­ç‰©æ·±åº¦3'],
            series: [
              { name: 'æµè§ˆ(pv)', data: [12000, 8500, 6000] },
              { name: 'æ”¶è—(fav)', data: [2500, 3200, 4500] },
              { name: 'åŠ è´­(cart)', data: [1800, 2800, 4200] },
              { name: 'è´­ä¹°(buy)', data: [800, 1500, 3000] }
            ]
          };
        case '/shoppingLevel/trend':
          return {
            xAxis: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00'],
            series: [
              { name: 'è´­ç‰©æ·±åº¦1', data: [350, 280, 800, 1200, 1500, 900] },
              { name: 'è´­ç‰©æ·±åº¦2', data: [420, 350, 950, 1500, 1800, 1100] },
              { name: 'è´­ç‰©æ·±åº¦3', data: [580, 480, 1200, 2000, 2500, 1800] }
            ]
          };
        case '/shoppingLevel/convert':
          return {
            xAxis: ['è´­ç‰©æ·±åº¦1', 'è´­ç‰©æ·±åº¦2', 'è´­ç‰©æ·±åº¦3'],
            series: [
              { name: 'ç‚¹å‡»è½¬åŒ–ç‡', data: [1.8, 2.5, 3.8] },
              { name: 'è´­ä¹°è½¬åŒ–ç‡', data: [0.6, 1.2, 2.5] }
            ]
          };
        default:
          return {};
      }
    }

    // ========== æ ¸å¿ƒä¿®å¤3ï¼šå›¾è¡¨æ¸²æŸ“å‡½æ•°é‡æ„ï¼ˆè§£å†³å®¹å™¨ä¸å­˜åœ¨é—®é¢˜ï¼‰ ==========
    // é€šç”¨å›¾è¡¨åˆå§‹åŒ–å‡½æ•°
    function initChart(chartId) {
      const chartDom = document.getElementById(chartId);
      if (!chartDom) {
        console.error(`å›¾è¡¨å®¹å™¨ä¸å­˜åœ¨ï¼š${chartId}`);
        return null;
      }
      // å¼ºåˆ¶è®¾ç½®å®¹å™¨å°ºå¯¸
      chartDom.style.width = '100%';
      chartDom.style.height = '400px';
      return echarts.init(chartDom);
    }

    // æ¸²æŸ“è¡Œä¸ºåˆ†å¸ƒå›¾è¡¨
    async function renderBehaviorChart() {
      const chartContainer = document.querySelector('.chart-container');
      // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
      if (chartContainer) {
        chartContainer.innerHTML = `
          <div class="loading">
            <i class="fas fa-spinner"></i>
            <p>æ•°æ®åŠ è½½ä¸­...</p>
          </div>
        `;
      }

      try {
        // è·å–æ•°æ®
        const behaviorData = await fetchApiData('/shoppingLevel/behavior');
        // ç­‰å¾…DOMå®Œå…¨æ¸²æŸ“
        await new Promise(resolve => setTimeout(resolve, 300));

        // åˆå§‹åŒ–å›¾è¡¨
        const myChart = initChart('behaviorChart');
        if (!myChart) {
          if (chartContainer) {
            chartContainer.innerHTML = `
              <div class="loading" style="color: #ff4444;">
                <i class="fas fa-exclamation-circle"></i>
                <p>å›¾è¡¨å®¹å™¨åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢</p>
              </div>
            `;
          }
          return;
        }

        const option = {
          backgroundColor: 'transparent',
          tooltip: {
            trigger: 'axis',
            axisPointer: { type: 'shadow' },
            textStyle: { color: '#fff' }
          },
          legend: {
            data: behaviorData.series.map(item => item.name),
            textStyle: { color: '#b8c2d9' }
          },
          grid: {
            left: '3%',
            right: '4%',
            bottom: '3%',
            containLabel: true
          },
          xAxis: {
            type: 'category',
            data: behaviorData.xAxis,
            axisLine: { lineStyle: { color: '#2a3655' } },
            axisLabel: { color: '#b8c2d9' }
          },
          yAxis: {
            type: 'value',
            axisLine: { lineStyle: { color: '#2a3655' } },
            axisLabel: { color: '#b8c2d9' },
            splitLine: { lineStyle: { color: 'rgba(42, 54, 85, 0.3)' } }
          },
          series: behaviorData.series.map(item => ({
            name: item.name,
            type: 'bar',
            data: item.data,
            itemStyle: { borderRadius: 4 }
          }))
        };

        myChart.setOption(option);
        // ç›‘å¬çª—å£å¤§å°å˜åŒ–
        window.addEventListener('resize', () => myChart.resize());
      } catch (e) {
        console.error('æ¸²æŸ“è¡Œä¸ºåˆ†å¸ƒå›¾è¡¨å¤±è´¥ï¼š', e);
        if (chartContainer) {
          chartContainer.innerHTML = `
            <div class="loading" style="color: #ff4444;">
              <i class="fas fa-exclamation-circle"></i>
              <p>å›¾è¡¨åŠ è½½å¤±è´¥ï¼š${e.message}</p>
            </div>
          `;
        }
      }
    }

    // æ¸²æŸ“æ—¶é—´è¶‹åŠ¿å›¾è¡¨
    async function renderTrendChart() {
      const chartContainer = document.querySelector('.chart-container');
      if (chartContainer) {
        chartContainer.innerHTML = `
          <div class="loading">
            <i class="fas fa-spinner"></i>
            <p>æ•°æ®åŠ è½½ä¸­...</p>
          </div>
        `;
      }

      try {
        const trendData = await fetchApiData('/shoppingLevel/trend');
        await new Promise(resolve => setTimeout(resolve, 300));

        const myChart = initChart('trendChart');
        if (!myChart) {
          if (chartContainer) {
            chartContainer.innerHTML = `
              <div class="loading" style="color: #ff4444;">
                <i class="fas fa-exclamation-circle"></i>
                <p>å›¾è¡¨å®¹å™¨åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢</p>
              </div>
            `;
          }
          return;
        }

        const colors = ['#00a1ff', '#00ffaa', '#e91e63'];
        const option = {
          backgroundColor: 'transparent',
          tooltip: { trigger: 'axis', textStyle: { color: '#fff' } },
          legend: {
            data: trendData.series.map(item => item.name),
            textStyle: { color: '#b8c2d9' }
          },
          grid: {
            left: '3%',
            right: '4%',
            bottom: '3%',
            containLabel: true
          },
          xAxis: {
            type: 'category',
            data: trendData.xAxis,
            axisLine: { lineStyle: { color: '#2a3655' } },
            axisLabel: { color: '#b8c2d9' }
          },
          yAxis: {
            type: 'value',
            axisLine: { lineStyle: { color: '#2a3655' } },
            axisLabel: { color: '#b8c2d9' },
            splitLine: { lineStyle: { color: 'rgba(42, 54, 85, 0.3)' } }
          },
          series: trendData.series.map((item, index) => ({
            name: item.name,
            type: 'line',
            data: item.data,
            smooth: true,
            lineStyle: { width: 3, color: colors[index] },
            itemStyle: { color: colors[index], borderRadius: 5 },
            symbol: 'circle',
            symbolSize: 8
          }))
        };

        myChart.setOption(option);
        window.addEventListener('resize', () => myChart.resize());
      } catch (e) {
        console.error('æ¸²æŸ“æ—¶é—´è¶‹åŠ¿å›¾è¡¨å¤±è´¥ï¼š', e);
        if (chartContainer) {
          chartContainer.innerHTML = `
            <div class="loading" style="color: #ff4444;">
              <i class="fas fa-exclamation-circle"></i>
              <p>å›¾è¡¨åŠ è½½å¤±è´¥ï¼š${e.message}</p>
            </div>
          `;
        }
      }
    }

    // æ¸²æŸ“è½¬åŒ–ç‡å›¾è¡¨
    async function renderConvertChart() {
      const chartContainer = document.querySelector('.chart-container');
      if (chartContainer) {
        chartContainer.innerHTML = `
          <div class="loading">
            <i class="fas fa-spinner"></i>
            <p>æ•°æ®åŠ è½½ä¸­...</p>
          </div>
        `;
      }

      try {
        const convertData = await fetchApiData('/shoppingLevel/convert');
        await new Promise(resolve => setTimeout(resolve, 300));

        const myChart = initChart('convertChart');
        if (!myChart) {
          if (chartContainer) {
            chartContainer.innerHTML = `
              <div class="loading" style="color: #ff4444;">
                <i class="fas fa-exclamation-circle"></i>
                <p>å›¾è¡¨å®¹å™¨åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢</p>
              </div>
            `;
          }
          return;
        }

        const colors = ['#9c27b0', '#4caf50'];
        const option = {
          backgroundColor: 'transparent',
          tooltip: {
            trigger: 'axis',
            textStyle: { color: '#fff' },
            formatter: '{b}: {c}%'
          },
          legend: {
            data: convertData.series.map(item => item.name),
            textStyle: { color: '#b8c2d9' }
          },
          grid: {
            left: '3%',
            right: '4%',
            bottom: '3%',
            containLabel: true
          },
          xAxis: {
            type: 'category',
            data: convertData.xAxis,
            axisLine: { lineStyle: { color: '#2a3655' } },
            axisLabel: { color: '#b8c2d9' }
          },
          yAxis: {
            type: 'value',
            axisLine: { lineStyle: { color: '#2a3655' } },
            axisLabel: { color: '#b8c2d9', formatter: '{value}%' },
            splitLine: { lineStyle: { color: 'rgba(42, 54, 85, 0.3)' } },
            min: 0,
            max: 5
          },
          series: convertData.series.map((item, index) => ({
            name: item.name,
            type: 'bar',
            data: item.data,
            itemStyle: {
              color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                { offset: 0, color: colors[index] },
                { offset: 1, color: colors[index] + '80' }
              ]),
              borderRadius: 4
            },
            label: {
              show: true,
              position: 'top',
              formatter: '{c}%',
              color: '#fff'
            }
          }))
        };

        myChart.setOption(option);
        window.addEventListener('resize', () => myChart.resize());
      } catch (e) {
        console.error('æ¸²æŸ“è½¬åŒ–ç‡å›¾è¡¨å¤±è´¥ï¼š', e);
        if (chartContainer) {
          chartContainer.innerHTML = `
            <div class="loading" style="color: #ff4444;">
              <i class="fas fa-exclamation-circle"></i>
              <p>å›¾è¡¨åŠ è½½å¤±è´¥ï¼š${e.message}</p>
            </div>
          `;
        }
      }
    }

    // ========== è·¯ç”±é…ç½®ï¼ˆä¿æŒåŸæœ‰ç»“æ„ï¼‰ ==========
    const routes = {
      '/index': {
        title: 'æ·˜å®å¹¿å‘Šç‚¹å‡»é‡å¤§æ•°æ®åˆ†æ',
        content: `
          <div class="welcome-bar">
            <div class="welcome-info">
              <div class="welcome-avatar">
                <i class="fas fa-chart-bar"></i>
              </div>
              <div class="welcome-text">
                <h3>æ·˜å®å¹¿å‘Šç‚¹å‡»é‡å¤§æ•°æ®åˆ†æç³»ç»Ÿ</h3>
                <p>å®æ—¶ç›‘æ§æ·˜å®å¹¿å‘Šç‚¹å‡»æ•°æ®ï¼Œæ·±åº¦åˆ†æç”¨æˆ·è¡Œä¸ºæ¨¡å¼<br>
                  åŸºäºå¤§æ•°æ®æŠ€æœ¯å®ç°ç²¾å‡†è¥é”€å†³ç­–æ”¯æŒ<br>
                  <span style="font-size: 14px; color: #00ffaa;">æ•°æ®æ¥æºï¼šæ·˜å®å¹¿å‘Šç³»ç»Ÿ | æ›´æ–°æ—¶é—´ï¼šå®æ—¶</span>
                </p>
              </div>
            </div>
            <div class="welcome-time">
              <div class="time-clock">00:34:05</div>
              <div class="time-date">2025å¹´12æœˆ5æ—¥ æ˜ŸæœŸäº”</div>
              <div class="time-weather">ğŸ“Š æ•°æ®è¿è¡Œæ­£å¸¸</div>
            </div>
          </div>

          <div class="data-cards">
            <div class="data-card" data-route="/requirement1">
              <div class="card-icon icon-purple">
                <i class="fas fa-clock"></i>
              </div>
              <div class="card-data">
                <h4>2.34%</h4>
                <p>å¹³å‡ç‚¹å‡»ç‡</p>
              </div>
            </div>
            <div class="data-card" data-route="/requirement2">
              <div class="card-icon icon-pink">
                <i class="fas fa-mouse-pointer"></i>
              </div>
              <div class="card-data">
                <h4>8.7M</h4>
                <p>æ—¥ç‚¹å‡»é‡</p>
              </div>
            </div>
            <div class="data-card" data-route="/requirement3">
              <div class="card-icon icon-blue">
                <i class="fas fa-users"></i>
              </div>
              <div class="card-data">
                <h4>156K</h4>
                <p>æ´»è·ƒç”¨æˆ·æ•°</p>
              </div>
            </div>
            <div class="data-card" data-route="/requirement4">
              <div class="card-icon icon-green">
                <i class="fas fa-map-marker-alt"></i>
              </div>
              <div class="card-data">
                <h4>32</h4>
                <p>è¦†ç›–åŸå¸‚æ•°</p>
              </div>
            </div>
          </div>

          <div class="dashboard-area">
            <div class="dashboard-card">
              <div class="dashboard-title">
                <i class="fas fa-chart-line"></i>
                <span>å®æ—¶ç‚¹å‡»è¶‹åŠ¿ç›‘æ§</span>
              </div>
              <div class="chart-container">
                <div style="text-align: center; color: #b8c2d9;">
                  <i class="fas fa-chart-line" style="font-size: 60px; margin-bottom: 20px; color: #00a1ff;"></i>
                  <p>å®æ—¶æ•°æ®å¯è§†åŒ–å±•ç¤º</p>
                  <p style="font-size: 14px; margin-top: 10px;">æ¯å°æ—¶æ›´æ–°ä¸€æ¬¡</p>
                </div>
              </div>
            </div>

            <div class="dashboard-card">
              <div class="dashboard-title">
                <i class="fas fa-chart-pie"></i>
                <span>ç”¨æˆ·è¡Œä¸ºåˆ†å¸ƒ</span>
              </div>
              <div class="chart-container">
                <div style="text-align: center; color: #b8c2d9;">
                  <i class="fas fa-pie-chart" style="font-size: 60px; margin-bottom: 20px; color: #00ffaa;"></i>
                  <p>ç‚¹å‡»/æœªç‚¹å‡»åˆ†å¸ƒæ¯”ä¾‹</p>
                  <p style="font-size: 14px; margin-top: 10px;">å®æ—¶ç»Ÿè®¡æ•°æ®</p>
                </div>
              </div>
            </div>
          </div>
        `
      },
      '/requirement1': {
        title: 'ç‚¹å‡»ç‡æ—¶é—´è¶‹åŠ¿åˆ†æ',
        content: `
          <div class="page-content">
            <h2 class="page-title">
              <i class="fas fa-clock"></i>
              å¹¿å‘Šç‚¹å‡»ç‡éšæ—¶é—´å˜åŒ–è¶‹åŠ¿åˆ†æ
            </h2>
            <p class="page-desc">
              åˆ†æå¹¿å‘Šç‚¹å‡»ç‡åœ¨ä¸åŒæ—¶é—´æ®µçš„åˆ†å¸ƒæƒ…å†µï¼Œè¯†åˆ«ç‚¹å‡»é«˜å³°æœŸå’Œä½è°·æœŸï¼Œä¸ºå¹¿å‘ŠæŠ•æ”¾æ—¶é—´ä¼˜åŒ–æä¾›æ•°æ®æ”¯æŒã€‚
            </p>

            <div class="detail-section">
              <div class="detail-title">ğŸ“Š æ•°æ®åˆ†ææ¦‚è§ˆ</div>
              <div class="detail-content">
                <div class="detail-item">
                  <strong>ç‰¹å¾å€¼ï¼š</strong>æ—¶é—´ã€å¹¿å‘Šç‚¹å‡»ç‡
                </div>
                <div class="detail-item">
                  <strong>æ•°æ®åº“å­—æ®µï¼š</strong>raw_sampleè¡¨ä¸­çš„time_stampï¼ˆæ—¶é—´æˆ³ï¼‰ã€clkï¼ˆç‚¹å‡»æ ‡è¯†ï¼‰
                </div>
                <div class="detail-item">
                  <strong>å¤„ç†ç®—æ³•ï¼š</strong>
                  <ol style="margin-left: 20px; margin-top: 10px;">
                    <li>æ•°æ®åŠ è½½ï¼šspark.read.parquet("hdfs://path/to/raw_sample")</li>
                    <li>æ—¶é—´å­—æ®µè½¬æ¢ï¼šæå–å°æ—¶ï¼ˆ0-23ï¼‰</li>
                    <li>åˆ†ç»„èšåˆï¼šæŒ‰å°æ—¶åˆ†ç»„ç»Ÿè®¡å±•ç¤ºæ¬¡æ•°å’Œç‚¹å‡»æ¬¡æ•°</li>
                    <li>ç‚¹å‡»ç‡è®¡ç®—ï¼šç‚¹å‡»ç‡ = (æ€»ç‚¹å‡»æ¬¡æ•° / æ€»å±•ç¤ºæ¬¡æ•°) Ã— 100</li>
                  </ol>
                </div>
              </div>
            </div>

            <div class="dashboard-area">
              <div class="dashboard-card">
                <div class="dashboard-title">
                  <i class="fas fa-chart-line"></i>
                  <span>24å°æ—¶ç‚¹å‡»ç‡è¶‹åŠ¿</span>
                </div>
                <div class="chart-container">
                  <div style="text-align: center; color: #b8c2d9;">
                    <i class="fas fa-chart-line" style="font-size: 60px; margin-bottom: 20px; color: #9c27b0;"></i>
                    <p>ç‚¹å‡»ç‡éšæ—¶é—´å˜åŒ–è¶‹åŠ¿å›¾</p>
                    <p style="font-size: 14px; margin-top: 10px;">é«˜å³°æœŸï¼š14:00-16:00</p>
                  </div>
                </div>
              </div>

              <div class="dashboard-card">
                <div class="dashboard-title">
                  <i class="fas fa-table"></i>
                  <span>æ•°æ®ç»Ÿè®¡è¡¨</span>
                </div>
                <div class="chart-container">
                  <div style="width: 100%; padding: 20px;">
                    <table style="width: 100%; border-collapse: collapse; color: #b8c2d9;">
                      <thead>
                        <tr style="background: rgba(0, 161, 255, 0.1);">
                          <th style="padding: 10px; text-align: left;">æ—¶é—´æ®µ</th>
                          <th style="padding: 10px; text-align: left;">å±•ç¤ºæ¬¡æ•°</th>
                          <th style="padding: 10px; text-align: left;">ç‚¹å‡»æ¬¡æ•°</th>
                          <th style="padding: 10px; text-align: left;">ç‚¹å‡»ç‡</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr style="border-bottom: 1px solid #2a3655;">
                          <td style="padding: 10px;">00:00-01:00</td>
                          <td style="padding: 10px;">125,432</td>
                          <td style="padding: 10px;">2,891</td>
                          <td style="padding: 10px; color: #4caf50;">2.31%</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #2a3655;">
                          <td style="padding: 10px;">14:00-15:00</td>
                          <td style="padding: 10px;">356,789</td>
                          <td style="padding: 10px;">9,876</td>
                          <td style="padding: 10px; color: #00ffaa;">2.77%</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        `
      },
      '/requirement2': {
        title: 'ç”¨æˆ·è¡Œä¸ºåˆ†å¸ƒåˆ†æ',
        content: `
          <div class="page-content">
            <h2 class="page-title">
              <i class="fas fa-chart-pie"></i>
              ç”¨æˆ·ç‚¹å‡»è¡Œä¸ºåˆ†å¸ƒåˆ†æ
            </h2>
            <p class="page-desc">
              åˆ†æç”¨æˆ·ç‚¹å‡»ä¸æœªç‚¹å‡»å¹¿å‘Šçš„æ•´ä½“åˆ†å¸ƒæƒ…å†µï¼Œäº†è§£å¹¿å‘Šçš„æ•´ä½“ç‚¹å‡»è¡¨ç°å’Œç”¨æˆ·è¡Œä¸ºç‰¹å¾ã€‚
            </p>

            <div class="detail-section">
              <div class="detail-title">ğŸ“ˆ æ•°æ®åˆ†å¸ƒåˆ†æ</div>
              <div class="detail-content">
                <div class="detail-item">
                  <strong>ç‰¹å¾å€¼ï¼š</strong>ç‚¹å‡»ã€æœªç‚¹å‡»
                </div>
                <div class="detail-item">
                  <strong>æ•°æ®åº“å­—æ®µï¼š</strong>raw_sampleè¡¨ä¸­çš„clkï¼ˆç‚¹å‡»æ ‡è¯†ï¼‰
                </div>
                <div class="detail-item">
                  <strong>å¤„ç†ç®—æ³•ï¼š</strong>
                  <ol style="margin-left: 20px; margin-top: 10px;">
                    <li>æ•´ä½“ç»Ÿè®¡ï¼šè®¡ç®—æ€»å±•ç¤ºæ¬¡æ•°å’Œæ€»ç‚¹å‡»æ¬¡æ•°</li>
                    <li>åˆ†å¸ƒè®¡ç®—ï¼šæœªç‚¹å‡»æ¬¡æ•° = æ€»å±•ç¤ºæ¬¡æ•° - æ€»ç‚¹å‡»æ¬¡æ•°</li>
                    <li>ç‚¹å‡»ç‡è®¡ç®—ï¼šå…¨å±€ç‚¹å‡»ç‡åˆ†æ</li>
                  </ol>
                </div>
              </div>
            </div>

            <div class="dashboard-area">
              <div class="dashboard-card">
                <div class="dashboard-title">
                  <i class="fas fa-pie-chart"></i>
                  <span>ç‚¹å‡»è¡Œä¸ºåˆ†å¸ƒå›¾</span>
                </div>
                <div class="chart-container">
                  <div style="text-align: center; color: #b8c2d9;">
                    <i class="fas fa-chart-pie" style="font-size: 80px; margin-bottom: 20px; color: #e91e63;"></i>
                    <p>ç‚¹å‡»ï¼š2.34%</p>
                    <p>æœªç‚¹å‡»ï¼š97.66%</p>
                    <p style="font-size: 14px; margin-top: 10px;">æ€»å±•ç¤ºæ¬¡æ•°ï¼š15,678,432</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        `
      },
      '/requirement3': {
        title: 'æ¶ˆè´¹æ¡£æ¬¡åˆ†æ',
        content: `
          <div class="page-content">
            <h2 class="page-title">
              <i class="fas fa-money-bill-wave"></i>
              ç”¨æˆ·æ¶ˆè´¹æ¡£æ¬¡ä¸ç‚¹å‡»ç‡å…³ç³»åˆ†æ
            </h2>
            <p class="page-desc">
              åˆ†æä¸åŒæ¶ˆè´¹æ¡£æ¬¡ç”¨æˆ·çš„å¹¿å‘Šç‚¹å‡»è¡Œä¸ºå·®å¼‚ï¼Œä¸ºç²¾å‡†è¥é”€å’Œç”¨æˆ·åˆ†å±‚è¿è¥æä¾›æ•°æ®ä¾æ®ã€‚
            </p>

            <div class="detail-section">
              <div class="detail-title">ğŸ’° æ¶ˆè´¹æ¡£æ¬¡åˆ†æ</div>
              <div class="detail-content">
                <div class="detail-item">
                  <strong>ç‰¹å¾å€¼ï¼š</strong>æ¶ˆè´¹æ¡£æ¬¡ã€ç‚¹å‡»ç‡
                </div>
                <div class="detail-item">
                  <strong>æ•°æ®åº“å­—æ®µï¼š</strong>user_profileè¡¨çš„pvalue_levelã€raw_sampleè¡¨çš„clk
                </div>
                <div class="detail-item">
                  <strong>å¤„ç†ç®—æ³•ï¼š</strong>
                  <ol style="margin-left: 20px; margin-top: 10px;">
                    <li>æ•°æ®å…³è”ï¼šuser_profileå’Œraw_sampleè¡¨è¿æ¥</li>
                    <li>åˆ†ç»„ç»Ÿè®¡ï¼šæŒ‰æ¶ˆè´¹æ¡£æ¬¡åˆ†ç»„</li>
                    <li>ç‚¹å‡»ç‡è®¡ç®—ï¼šå„æ¡£æ¬¡ç‚¹å‡»ç‡åˆ†æ</li>
                  </ol>
                </div>
              </div>
            </div>
          </div>
        `
      },
      '/requirement4': {
        title: 'åŸå¸‚å±‚çº§åå¥½åˆ†æ',
        content: `
          <div class="page-content">
            <h2 class="page-title">
              <i class="fas fa-city"></i>
              ä¸åŒåŸå¸‚å±‚çº§å¹¿å‘Šç‚¹å‡»åå¥½åˆ†æ
            </h2>
            <p class="page-desc">
              åˆ†æä¸åŒåŸå¸‚å±‚çº§ç”¨æˆ·å¯¹å¹¿å‘Šå“ç‰Œ/å“ç±»çš„ç‚¹å‡»åå¥½ï¼Œä¸ºåœ°åŸŸåŒ–å¹¿å‘ŠæŠ•æ”¾ç­–ç•¥æä¾›æ•°æ®æ”¯æŒã€‚
            </p>

            <div class="detail-section">
              <div class="detail-title">ğŸ™ï¸ åŸå¸‚å±‚çº§åˆ†æ</div>
              <div class="detail-content">
                <div class="detail-item">
                  <strong>ç‰¹å¾å€¼ï¼š</strong>åŸå¸‚å±‚çº§ã€å“ç‰Œ/å“ç±»ã€ç‚¹å‡»ç‡
                </div>
                <div class="detail-item">
                  <strong>æ•°æ®åº“å­—æ®µï¼š</strong>user_profileè¡¨çš„new_user_class_levelã€ad_featureè¡¨çš„brand/cate_id
                </div>
                <div class="detail-item">
                  <strong>å¤„ç†ç®—æ³•ï¼š</strong>
                  <ol style="margin-left: 20px; margin-top: 10px;">
                    <li>ä¸‰è¡¨å…³è”ï¼šuser_profileã€raw_sampleã€ad_feature</li>
                    <li>åˆ†ç»„èšåˆï¼šæŒ‰åŸå¸‚å±‚çº§å’Œå“ç‰Œ/å“ç±»åˆ†ç»„</li>
                    <li>Top 3ç­›é€‰ï¼šå„åŸå¸‚å±‚çº§ç‚¹å‡»ç‡å‰ä¸‰å</li>
                  </ol>
                </div>
              </div>
            </div>
          </div>
        `
      },
      '/requirement5': {
        title: 'è´­ç‰©æ·±åº¦åˆ†æ',
        content: `
          <div class="page-content">
            <h2 class="page-title">
              <i class="fas fa-shopping-cart"></i>
              è´­ç‰©æ·±åº¦ç”¨æˆ·ä»·å€¼åˆ†æ
            </h2>
            <p class="page-desc">
              åˆ†æä¸åŒè´­ç‰©æ·±åº¦ç”¨æˆ·çš„è¡Œä¸ºç‰¹å¾ã€è½¬åŒ–ç‡å’ŒLTVï¼ˆç”¨æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ï¼‰ï¼Œä¸ºç²¾ç»†åŒ–ç”¨æˆ·è¿è¥æä¾›å†³ç­–ä¾æ®ã€‚
            </p>

            <div class="detail-section">
              <div class="detail-title">ğŸ›’ è´­ç‰©æ·±åº¦åˆ†æ</div>
              <div class="detail-content">
                <div class="detail-item">
                  <strong>ç‰¹å¾å€¼ï¼š</strong>è´­ç‰©æ·±åº¦ã€æ´»è·ƒåº¦ã€è½¬åŒ–ç‡ã€LTV
                </div>
                <div class="detail-item">
                  <strong>æ•°æ®åº“å­—æ®µï¼š</strong>user_profileè¡¨çš„shopping_levelã€behavior_logè¡¨çš„btag
                </div>
                <div class="detail-item">
                  <strong>å¤„ç†ç®—æ³•ï¼š</strong>
                  <ol style="margin-left: 20px; margin-top: 10px;">
                    <li>ä¸‰è¡¨å…³è”ï¼šuser_profileã€behavior_logã€raw_sample</li>
                    <li>æŒ‡æ ‡è®¡ç®—ï¼šæ´»è·ƒåº¦ã€è½¬åŒ–ç‡ã€LTVç­‰å…³é”®æŒ‡æ ‡</li>
                    <li>åˆ†å±‚åˆ†æï¼šæŒ‰è´­ç‰©æ·±åº¦è¿›è¡Œç”¨æˆ·åˆ†å±‚</li>
                  </ol>
                </div>
              </div>
            </div>
          </div>
        `
      },
      '/shoppingLevel/behavior': {
        title: 'è´­ç‰©æ·±åº¦-è¡Œä¸ºåˆ†å¸ƒ',
        content: `
          <div class="page-content">
            <h2 class="page-title">
              <i class="fas fa-list"></i>
              è´­ç‰©æ·±åº¦-ç”¨æˆ·è¡Œä¸ºåˆ†å¸ƒåˆ†æ
            </h2>
            <p class="page-desc">
              åˆ†æä¸åŒè´­ç‰©æ·±åº¦ç”¨æˆ·çš„è¡Œä¸ºåˆ†å¸ƒï¼ˆæµè§ˆã€æ”¶è—ã€åŠ è´­ã€è´­ä¹°ï¼‰ï¼Œè¯†åˆ«é«˜ä»·å€¼ç”¨æˆ·çš„è¡Œä¸ºç‰¹å¾ã€‚
            </p>

            <div class="detail-section">
              <div class="detail-title">ğŸ“Š æ•°æ®è¯´æ˜</div>
              <div class="detail-content">
                <div class="detail-item">
                  <strong>æ•°æ®æ¥æºï¼š</strong>åç«¯æ¥å£ /api/shoppingLevel/behavior
                </div>
                <div class="detail-item">
                  <strong>ç»Ÿè®¡ç»´åº¦ï¼š</strong>æŒ‰è´­ç‰©æ·±åº¦åˆ†å±‚ï¼Œç»Ÿè®¡å„è¡Œä¸ºç±»å‹çš„ç”¨æˆ·æ•°
                </div>
                <div class="detail-item">
                  <strong>æ ¸å¿ƒç»“è®ºï¼š</strong>è´­ç‰©æ·±åº¦è¶Šé«˜ï¼Œè´­ä¹°è½¬åŒ–è¡Œä¸ºå æ¯”è¶Šé«˜
                </div>
              </div>
            </div>

            <div class="dashboard-area">
              <div class="dashboard-card" style="grid-column: span 2;">
                <div class="dashboard-title">
                  <i class="fas fa-chart-bar"></i>
                  <span>ä¸åŒè´­ç‰©æ·±åº¦ç”¨æˆ·è¡Œä¸ºåˆ†å¸ƒ</span>
                </div>
                <div class="chart-container">
                  <div id="behaviorChart"></div>
                </div>
              </div>
            </div>
          </div>
        `,
        afterRender: renderBehaviorChart
      },
      '/shoppingLevel/trend': {
        title: 'è´­ç‰©æ·±åº¦-æ—¶é—´è¶‹åŠ¿',
        content: `
          <div class="page-content">
            <h2 class="page-title">
              <i class="fas fa-chart-line"></i>
              è´­ç‰©æ·±åº¦-ç”¨æˆ·æ´»è·ƒæ—¶é—´è¶‹åŠ¿
            </h2>
            <p class="page-desc">
              åˆ†æä¸åŒè´­ç‰©æ·±åº¦ç”¨æˆ·åœ¨ä¸€å¤©å†…çš„æ´»è·ƒæ—¶é—´è¶‹åŠ¿ï¼Œä¸ºåˆ†æ—¶æ®µç²¾å‡†è¥é”€æä¾›æ•°æ®æ”¯æŒã€‚
            </p>

            <div class="detail-section">
              <div class="detail-title">ğŸ“ˆ æ•°æ®è¯´æ˜</div>
              <div class="detail-content">
                <div class="detail-item">
                  <strong>æ•°æ®æ¥æºï¼š</strong>åç«¯æ¥å£ /api/shoppingLevel/trend
                </div>
                <div class="detail-item">
                  <strong>ç»Ÿè®¡ç»´åº¦ï¼š</strong>æŒ‰å°æ—¶ç»Ÿè®¡ä¸åŒè´­ç‰©æ·±åº¦ç”¨æˆ·çš„æ´»è·ƒæ¬¡æ•°
                </div>
                <div class="detail-item">
                  <strong>æ ¸å¿ƒç»“è®ºï¼š</strong>é«˜è´­ç‰©æ·±åº¦ç”¨æˆ·åœ¨16:00-20:00æ´»è·ƒåº¦æœ€é«˜
                </div>
              </div>
            </div>

            <div class="dashboard-area">
              <div class="dashboard-card" style="grid-column: span 2;">
                <div class="dashboard-title">
                  <i class="fas fa-chart-line"></i>
                  <span>ä¸åŒè´­ç‰©æ·±åº¦ç”¨æˆ·æ´»è·ƒæ—¶é—´è¶‹åŠ¿</span>
                </div>
                <div class="chart-container">
                  <div id="trendChart"></div>
                </div>
              </div>
            </div>
          </div>
        `,
        afterRender: renderTrendChart
      },
      '/shoppingLevel/convert': {
        title: 'è´­ç‰©æ·±åº¦-è½¬åŒ–ç‡åˆ†æ',
        content: `
          <div class="page-content">
            <h2 class="page-title">
              <i class="fas fa-percentage"></i>
              è´­ç‰©æ·±åº¦-ç”¨æˆ·è½¬åŒ–ç‡åˆ†æ
            </h2>
            <p class="page-desc">
              åˆ†æä¸åŒè´­ç‰©æ·±åº¦ç”¨æˆ·çš„ç‚¹å‡»è½¬åŒ–ç‡å’Œè´­ä¹°è½¬åŒ–ç‡ï¼Œè¯„ä¼°ä¸åŒå±‚çº§ç”¨æˆ·çš„å•†ä¸šä»·å€¼ã€‚
            </p>

            <div class="detail-section">
              <div class="detail-title">ğŸ¯ æ•°æ®è¯´æ˜</div>
              <div class="detail-content">
                <div class="detail-item">
                  <strong>æ•°æ®æ¥æºï¼š</strong>åç«¯æ¥å£ /api/shoppingLevel/convert
                </div>
                <div class="detail-item">
                  <strong>ç»Ÿè®¡ç»´åº¦ï¼š</strong>æŒ‰è´­ç‰©æ·±åº¦åˆ†å±‚ï¼Œè®¡ç®—ç‚¹å‡»/è´­ä¹°è½¬åŒ–ç‡
                </div>
                <div class="detail-item">
                  <strong>æ ¸å¿ƒç»“è®ºï¼š</strong>è´­ç‰©æ·±åº¦3çº§ç”¨æˆ·çš„è´­ä¹°è½¬åŒ–ç‡æ˜¯1çº§ç”¨æˆ·çš„4å€+
                </div>
              </div>
            </div>

            <div class="dashboard-area">
              <div class="dashboard-card" style="grid-column: span 2;">
                <div class="dashboard-title">
                  <i class="fas fa-chart-bar"></i>
                  <span>ä¸åŒè´­ç‰©æ·±åº¦ç”¨æˆ·è½¬åŒ–ç‡å¯¹æ¯”</span>
                </div>
                <div class="chart-container">
                  <div id="convertChart"></div>
                </div>
              </div>
            </div>
          </div>
        `,
        afterRender: renderConvertChart
      },
      '/detail': {
        title: 'è¯¦æƒ…åˆ†ææŠ¥å‘Š',
        content: `
          <div class="page-content">
            <h2 class="page-title">
              <i class="fas fa-file-alt"></i>
              å¹¿å‘Šæ•°æ®åˆ†æè¯¦æƒ…æŠ¥å‘Š
            </h2>
            <p class="page-desc">
              æœ¬æŠ¥å‘ŠåŸºäºæ·˜å®å¹¿å‘Šç‚¹å‡»å¤§æ•°æ®ï¼Œä»äº”ä¸ªç»´åº¦æ·±åº¦åˆ†æç”¨æˆ·è¡Œä¸ºç‰¹å¾å’Œå¹¿å‘Šè¡¨ç°ï¼Œä¸ºè¥é”€å†³ç­–æä¾›å…¨é¢æ•°æ®æ”¯æŒã€‚
            </p>

            <div class="detail-section">
              <div class="detail-title">ğŸ“‹ åˆ†æé¡¹ç›®æ¦‚è§ˆ</div>
              <div class="detail-content">
                <div class="detail-item">
                  <strong>1. æ—¶é—´è¶‹åŠ¿åˆ†æï¼š</strong>è¯†åˆ«å¹¿å‘Šç‚¹å‡»çš„é«˜å³°æœŸå’Œä½è°·æœŸï¼Œä¼˜åŒ–æŠ•æ”¾æ—¶é—´ç­–ç•¥
                </div>
                <div class="detail-item">
                  <strong>2. è¡Œä¸ºåˆ†å¸ƒåˆ†æï¼š</strong>äº†è§£æ•´ä½“ç‚¹å‡»ç‡è¡¨ç°ï¼Œè¯„ä¼°å¹¿å‘Šæ•ˆæœ
                </div>
                <div class="detail-item">
                  <strong>3. æ¶ˆè´¹æ¡£æ¬¡åˆ†æï¼š</strong>è¯†åˆ«ä¸åŒæ¶ˆè´¹èƒ½åŠ›ç”¨æˆ·çš„ç‚¹å‡»åå¥½
                </div>
                <div class="detail-item">
                  <strong>4. åŸå¸‚å±‚çº§åˆ†æï¼š</strong>åˆ†æåœ°åŸŸå·®å¼‚å¯¹å¹¿å‘Šæ•ˆæœçš„å½±å“
                </div>
                <div class="detail-item">
                  <strong>5. è´­ç‰©æ·±åº¦åˆ†æï¼š</strong>è¯„ä¼°ä¸åŒç”¨æˆ·ç¾¤ä½“çš„é•¿æœŸä»·å€¼
                </div>
              </div>
            </div>

            <div class="detail-section">
              <div class="detail-title">ğŸ¯ å…³é”®å‘ç°</div>
              <div class="detail-content">
                <div class="detail-item">
                  <strong>æœ€ä½³æŠ•æ”¾æ—¶é—´ï¼š</strong>14:00-16:00ä¸ºç‚¹å‡»é«˜å³°æœŸï¼Œç‚¹å‡»ç‡è¾¾2.77%
                </div>
                <div class="detail-item">
                  <strong>é«˜ä»·å€¼ç”¨æˆ·ç¾¤ä½“ï¼š</strong>æ¶ˆè´¹æ¡£æ¬¡é«˜çš„ç”¨æˆ·ç‚¹å‡»ç‡æ˜¾è‘—é«˜äºæ™®é€šç”¨æˆ·
                </div>
                <div class="detail-item">
                  <strong>åœ°åŸŸå·®å¼‚ï¼š</strong>ä¸€çº¿åŸå¸‚ç”¨æˆ·å¯¹å“ç‰Œå¹¿å‘Šæ¥å—åº¦æ›´é«˜
                </div>
                <div class="detail-item">
                  <strong>æ·±åº¦ç”¨æˆ·ä»·å€¼ï¼š</strong>è´­ç‰©æ·±åº¦3çº§ç”¨æˆ·çš„LTVæ˜¯æµ…å±‚ç”¨æˆ·çš„3å€
                </div>
              </div>
            </div>

            <div class="detail-section">
              <div class="detail-title">ğŸ’¡ ä¼˜åŒ–å»ºè®®</div>
              <div class="detail-content">
                <div class="detail-item">
                  1. åœ¨14:00-16:00é«˜å³°æœŸå¢åŠ å¹¿å‘ŠæŠ•æ”¾é¢„ç®—
                </div>
                <div class="detail-item">
                  2. é’ˆå¯¹é«˜æ¶ˆè´¹æ¡£æ¬¡ç”¨æˆ·è®¾è®¡ä¸“å±å¹¿å‘Šå†…å®¹
                </div>
                <div class="detail-item">
                  3. æ ¹æ®ä¸åŒåŸå¸‚å±‚çº§è°ƒæ•´å¹¿å‘Šç­–ç•¥å’Œå†…å®¹
                </div>
                <div class="detail-item">
                  4. é‡ç‚¹ç»´æŠ¤è´­ç‰©æ·±åº¦3çº§çš„é«˜ä»·å€¼ç”¨æˆ·
                </div>
              </div>
            </div>
          </div>
        `
      }
    };

    // ========== æ ¸å¿ƒä¿®å¤4ï¼šèœå•æŠ˜å åŠŸèƒ½ä¼˜åŒ– ==========
    const shoppingLevelParent = document.getElementById('shoppingLevelParent');
    const shoppingLevelSubmenu = document.getElementById('shoppingLevelSubmenu');
    let isSubmenuOpen = false;
    shoppingLevelParent.classList.add('collapsed');

    shoppingLevelParent.addEventListener('click', function(e) {
      e.stopPropagation();
      isSubmenuOpen = !isSubmenuOpen;
      if (isSubmenuOpen) {
        shoppingLevelSubmenu.classList.add('show');
        shoppingLevelParent.classList.remove('collapsed');
      } else {
        shoppingLevelSubmenu.classList.remove('show');
        shoppingLevelParent.classList.add('collapsed');
      }
    });

    // ========== æ ¸å¿ƒä¿®å¤5ï¼šè·¯ç”±é€»è¾‘å¢å¼ºï¼ˆè§£å†³æ¸²æŸ“æ—¶æœºé—®é¢˜ï¼‰ ==========
    const contentWrapper = document.getElementById('contentWrapper');
    const currentPageTitle = document.getElementById('currentPageTitle');
    const menuItems = document.querySelectorAll('.menu-item[data-route]');
    const sidebarToggle = document.getElementById('sidebarToggle');
    const sidebar = document.querySelector('.sidebar');

    // åˆ‡æ¢è·¯ç”±çš„æ ¸å¿ƒå‡½æ•°ï¼ˆå»¶é•¿æ¸²æŸ“å»¶è¿Ÿï¼‰
    function navigateTo(route) {
      if (!routes[route]) route = '/index';

      window.location.hash = route;
      contentWrapper.innerHTML = routes[route].content;
      currentPageTitle.textContent = routes[route].title;

      // æ›´æ–°èœå•æ¿€æ´»çŠ¶æ€
      menuItems.forEach(item => {
        item.classList.remove('active');
        if (item.dataset.route === route) {
          item.classList.add('active');
          // è‡ªåŠ¨å±•å¼€è´­ç‰©æ·±åº¦å­èœå•
          if (route.startsWith('/shoppingLevel')) {
            isSubmenuOpen = true;
            shoppingLevelSubmenu.classList.add('show');
            shoppingLevelParent.classList.remove('collapsed');
          }
        }
      });

      // æ ¸å¿ƒä¿®å¤ï¼šå»¶è¿Ÿ1000msæ‰§è¡Œæ¸²æŸ“ï¼Œç¡®ä¿DOMå®Œå…¨åŠ è½½
      if (routes[route].afterRender) {
        setTimeout(() => {
          routes[route].afterRender();
        }, 1000);
      }

      bindContentRoutes();
      updateTime();
    }

    // ä¸ºå†…å®¹ä¸­çš„å¯ç‚¹å‡»å…ƒç´ ç»‘å®šè·¯ç”±
    function bindContentRoutes() {
      const contentItems = contentWrapper.querySelectorAll('[data-route]');
      contentItems.forEach(item => {
        item.addEventListener('click', function () {
          navigateTo(this.dataset.route);
        });
      });
    }

    // ç›‘å¬Hashå˜åŒ–
    window.addEventListener('hashchange', function () {
      const currentRoute = window.location.hash.slice(1) || '/index';
      navigateTo(currentRoute);
    });

    // èœå•ç‚¹å‡»äº‹ä»¶
    menuItems.forEach(item => {
      item.addEventListener('click', function () {
        navigateTo(this.dataset.route);
      });
    });

    // ä¾§è¾¹æ æ”¶ç¼©/å±•å¼€
    sidebarToggle.addEventListener('click', function () {
      sidebar.style.width = sidebar.style.width === '60px' ? '200px' : '60px';
    });

    // é¡µé¢åˆå§‹åŒ–
    window.addEventListener('load', function () {
      const initialRoute = window.location.hash.slice(1) || '/index';
      navigateTo(initialRoute);
      bindContentRoutes();
    });
  </script>
</body>

</html>